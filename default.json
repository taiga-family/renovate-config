{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": [":semanticCommitScopeDisabled"],
    "onboarding": false,
    "requireConfig": "optional",
    "baseBranchPatterns": ["main"],
    "branchPrefix": "renovate/",
    "timezone": "Europe/Moscow",
    "enabledManagers": ["npm", "gitlabci", "dockerfile", "github-actions"],
    "fetchChangeLogs": "off",
    "internalChecksFilter": "strict",
    "prHourlyLimit": 0,
    "branchConcurrentLimit": 2,
    "prConcurrentLimit": 3,
    "rebaseWhen": "auto",
    "recreateWhen": "always",
    "semanticCommits": "enabled",
    "commitMessageLowerCase": "auto",
    "labels": ["dependencies"],
    "automerge": false,
    "autoApprove": true,
    "separateMajorMinor": true,
    "separateMinorPatch": false,
    "dependencyDashboard": false,
    "dependencyDashboardApproval": false,
    "repositoryCache": "enabled",
    "rollbackPrs": true,
    "digest": {"enabled": false},
    "pinDigests": false,
    "skipInstalls": true,
    "cloneSubmodules": true,
    "allowScripts": true,
    "allowCustomCrateRegistries": true,
    "exposeAllEnv": true,
    "includePaths": [
        "**/package.json",
        "**/package-lock.json",
        ".github/workflows/**",
        "**/Dockerfile",
        "**/dockerfile",
        ".gitlab-ci.yml",
        ".gitlab/**"
    ],
    "suppressNotifications": ["configErrorIssue", "dependencyLookupWarnings"],
    "prBodyTemplate": "{{{table}}}{{{notes}}}{{{changelogs}}}{{{controls}}}{{{footer}}}",
    "prBodyColumns": ["Package", "Type", "Change"],
    "postUpgradeTasks": {
        "commands": [
            "rm -rf package-lock.json node_modules **/node_modules",
            "ws=$(node -p '!!require(`./package.json`).workspaces') && npm i -ws=$ws --include-workspace-root=$ws && npm i -ws=$ws --include-workspace-root=$ws",
            "git add . && npx lint-staged --allow-empty || true"
        ],
        "executionMode": "branch",
        "fileFilters": ["**/package.json"]
    },
    "packageRules": [
        {
            "matchDepTypes": ["overrides"],
            "enabled": false
        },
        {
            "enabled": true,
            "matchUpdateTypes": ["major", "minor", "patch"]
        },
        {
            "matchDepTypes": ["devDependencies", "dependencies"],
            "rangeStrategy": "pin"
        },
        {
            "matchDepTypes": ["peerDependencies", "optionalDependencies"],
            "rangeStrategy": "bump"
        },
        {
            "groupName": "tiptap",
            "matchPackageNames": ["/^@tiptap/.*/"]
        },
        {
            "groupName": "playwright",
            "matchPackageNames": ["/^@playwright/.*/", "@axe-core/playwright", "axe-playwright"]
        },
        {
            "groupName": "maskito",
            "matchPackageNames": ["/^@maskito/.*/"]
        },
        {
            "groupName": "cspell",
            "matchPackageNames": ["/^@cspell/.*/"]
        },
        {
            "groupName": "prosemirror",
            "matchPackageNames": ["/^prosemirror.*/"]
        },
        {
            "groupName": "definitely typed",
            "matchPackageNames": ["/^@types/.*/"]
        },
        {
            "groupName": "prettier",
            "matchPackageNames": ["/^prettier/", "/^@prettier/.*/", "/^prettier-.*/"]
        },
        {
            "groupName": "cypress",
            "matchPackageNames": ["/^cypress/", "/^cy2/", "/^cypress-.*/"]
        },
        {"groupName": "commitlint", "matchPackageNames": ["/^@commitlint/.*/"]},
        {
            "groupName": "release-it",
            "matchPackageNames": ["/^@release-it/.*/", "/^release-it$/"]
        },
        {
            "groupName": "docsearch",
            "matchPackageNames": ["/^@docsearch/.*/"]
        },
        {
            "groupName": "tinkoff",
            "matchPackageNames": ["/^@tinkoff/.*/"]
        },
        {
            "groupName": "rollup",
            "matchPackageNames": ["/^rollup.*/", "/@rollup/pluginutils/"]
        },
        {
            "groupName": "swc",
            "matchPackageNames": ["/^@swc.*/"]
        },
        {
            "groupName": "stackblitz sdk",
            "matchPackageNames": ["/^@stackblitz/.*/"]
        },
        {
            "groupName": "babel",
            "matchPackageNames": ["/^@babel/eslint-.*/", "/babel.*/"]
        },
        {
            "groupName": "jest",
            "matchPackageNames": ["/^jest.*/", "/^ts-jest$/", "/^jest-preset-angular$/"]
        },
        {
            "groupName": "react",
            "extends": ["monorepo:react"],
            "matchPackageNames": ["/^react.*/", "/^@types/react$/", "/^@types/react-.*/", "/^react-.*/"]
        },
        {
            "groupName": "vue",
            "matchPackageNames": ["/^vue.*/"]
        },
        {
            "groupName": "eslint",
            "matchPackageNames": ["/^eslint.*/"]
        },
        {
            "groupName": "jasmine",
            "matchPackageNames": ["/^jasmine.*/"]
        },
        {
            "groupName": "@ng-web-apis/* deps",
            "matchPackageNames": ["/^@ng-web-apis/.*/"]
        },
        {
            "groupName": "@stylistic/* deps",
            "matchPackageNames": ["/^@stylistic/.*/"]
        },
        {
            "groupName": "@angular-eslint/* deps",
            "matchPackageNames": ["/^@angular-eslint.*/"]
        },
        {
            "groupName": "@typescript-eslint/* deps",
            "matchPackageNames": ["/^@typescript-eslint/.*/", "typescript-eslint"]
        },
        {
            "groupName": "nx",
            "matchPackageNames": ["/^nx$/", "/^@nx.*/"],
            "postUpgradeTasks": {
                "commands": [
                    "npm install nx@{{{currentVersion}}} --force --no-save --no-audit --no-fund --ignore-scripts --loglevel silent",
                    "npx nx migrate nx@{{{newVersion}}} || true",
                    "NX_MIGRATE_SKIP_INSTALL=true npx nx migrate --run-migrations --ifExists && rm -f migrations.json || true",
                    "npx nx repair || true"
                ],
                "executionMode": "branch",
                "fileFilters": ["**/package.json"]
            }
        },
        {
            "groupName": "@angular/* deps",
            "matchPackageNames": [
                "/^@angular.*/",
                "/^@angular-devkit.*/",
                "!/^@angular-eslint.*/",
                "/^@schematics.*/",
                "/^typescript$/",
                "/^ng-packagr$/",
                "!@angular/cdk"
            ],
            "postUpgradeTasks": {
                "commands": [
                    "npm install nx --force --no-save --no-audit --no-fund --ignore-scripts --loglevel silent",
                    "npm view @angular/core@{{{newVersion}}} version > /dev/null 2>&1 && npx nx migrate @angular/core@{{{newVersion}}} || true",
                    "npm view @angular/cli@{{{newVersion}}} version > /dev/null 2>&1 && npx nx migrate @angular/cli@{{{newVersion}}} || true",
                    "NX_MIGRATE_SKIP_INSTALL=true npx nx migrate --run-migrations --ifExists && rm -f migrations.json || true"
                ],
                "executionMode": "branch",
                "fileFilters": ["**/package.json"]
            }
        },
        {
            "groupName": "@angular/cdk migrations",
            "matchPackageNames": ["@angular/cdk"],
            "postUpgradeTasks": {
                "commands": [
                    "npm install nx --force --no-save --no-audit --no-fund --ignore-scripts --loglevel silent",
                    "npx nx migrate @angular/cdk@{{{newVersion}}} || true"
                ],
                "executionMode": "branch",
                "fileFilters": ["**/package.json"]
            }
        },
        {
            "groupName": "@taiga-ui/* deps",
            "matchPackageNames": ["/^@taiga-ui/.*/", "!@taiga-ui/editor"],
            "postUpgradeTasks": {
                "commands": [
                    "npm install nx --force --no-save --no-audit --no-fund --ignore-scripts --loglevel silent",
                    "npm view @taiga-ui/cdk@{{{newVersion}}} version > /dev/null 2>&1 && npx nx migrate @taiga-ui/cdk@{{{newVersion}}} || true",
                    "NX_MIGRATE_SKIP_INSTALL=true npx nx migrate --run-migrations --ifExists && rm -f migrations.json || true"
                ],
                "executionMode": "branch",
                "fileFilters": ["**/package.json"]
            }
        },
        {
            "matchManagers": ["github-actions"],
            "matchDatasources": ["github-actions"],
            "matchUpdateTypes": ["major", "minor", "patch"]
        },
        {
            "enabled": false,
            "matchDepTypes": ["engines"]
        },
        {
            "enabled": false,
            "matchUpdateTypes": ["major", "minor"],
            "matchPackageNames": ["/^typescript$/", "/^rxjs$/"]
        },
        {
            "enabled": false,
            "matchUpdateTypes": ["major"],
            "matchPackageNames": [
                "/^@angular.*/",
                "/^@schematics.*/",
                "/^@nguniversal.*/",
                "/^ngx-highlightjs$/",
                "/^ngx-markdown$/",
                "/^ng-packagr/",
                "/^eslint$/",
                "/^glob$/"
            ]
        },
        {
            "enabled": false,
            "matchDepTypes": ["peerDependencies", "optionalDependencies"],
            "matchPackageNames": [
                "/^libphonenumber-js$/",
                "/^highlight.js$/",
                "/^typescript$/",
                "/^react$/",
                "/^vue$/",
                "/^zone.js$/",
                "/^rxjs$/",
                "/^@angular.*/",
                "/^@schematics.*/",
                "/^react.*/",
                "/^vue.*/"
            ]
        },
        {"enabled": false, "groupName": "react", "matchUpdateTypes": ["major"]}
    ]
}
